<div class="skill-detail-page">
    <div class="container">
        <!-- Breadcrumbs -->
        <nav class="breadcrumbs">
            <a href="/">Home</a>
            <i class="bi bi-chevron-right"></i>
            <a href="/search">Skills</a>
            <i class="bi bi-chevron-right"></i>
            <span>{{skill.name}}</span>
        </nav>
    </div>

    <!-- Hero Section -->
    <section class="skill-hero">
        <div class="container">
            <div class="skill-hero-content">
                <div class="skill-category-badge">
                    <img src="{{categoryImage skill.category}}" alt="{{skill.category}}">
                    <span>{{skill.category}}</span>
                </div>

                <h1>{{skill.name}}</h1>

                <p class="skill-hero-description">{{skill.description}}</p>

                <div class="skill-hero-meta">
                    <div class="skill-owner-info">
                        <a href="/profile/{{skill.owner.id}}">
                            <img src="https://i.pravatar.cc/150?u={{skill.owner.email}}"
                                 alt="{{skill.owner.username}}"
                                 class="skill-owner-avatar">
                        </a>
                        <div>
                            <div class="skill-owner-name">{{skill.owner.username}}</div>
                        </div>
                    </div>

                    <div class="skill-rating-display">
                        <div class="skill-rating-number">{{skill.averageRate}}</div>
                        <div>
                            <div class="skill-rating-stars" data-rate="{{skill.averageRate}}">
                                <span class="star">&#9733;</span>
                                <span class="star">&#9733;</span>
                                <span class="star">&#9733;</span>
                                <span class="star">&#9733;</span>
                                <span class="star">&#9733;</span>
                            </div>
                            <div class="skill-rating-count">{{skill.ratings.length}} reviews</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container">
        <div class="skill-detail-grid">
            <!-- Main Info Card -->
            <div class="skill-main-card">
                <div class="skill-section">
                    <h3>
                        <i class="bi bi-info-circle"></i>
                        About this Skill
                    </h3>
                    <p>{{skill.description}}</p>
                </div>

                <div class="skill-section">
                    <h3>
                        <i class="bi bi-tag"></i>
                        Category
                    </h3>
                    <p style="text-transform: capitalize;">{{skill.category}}</p>
                </div>

                <div class="skill-section">
                    <h3>
                        <i class="bi bi-person"></i>
                        Instructor
                    </h3>
                    <p>Learn from <strong>{{skill.owner.username}}</strong></p>
                    {{#if skill.owner.description}}
                        <p style="margin-top: var(--space-2);">{{skill.owner.description}}</p>
                    {{/if}}
                </div>

                {{#if isUserLogged}}
                    <div class="skill-actions">
                        <a href="/skills/{{skill.id}}/edit" class="btn-edit">
                            <i class="bi bi-pencil"></i>
                            Edit Skill
                        </a>
                    </div>
                {{/if}}
            </div>

            <!-- Sidebar - Comments & Ratings -->
            <aside class="skill-sidebar">
                <div class="comments-card">
                    <h3><i class="bi bi-chat-dots"></i> Reviews</h3>

                    <!-- Rating Form -->
                    {{#ifUserRated skill.ratings currentUser}}
                        {{#unless isUserLogged}}
                            <form action="/detail/{{skill.id}}" method="post" class="rating-form">
                                <textarea
                                    class="form-control"
                                    name="comment"
                                    placeholder="Share your experience with this skill..."
                                    required
                                ></textarea>

                                <div style="font-size: 30px;" class="rate {{#if errors.rate}}is-invalid{{/if}}">
                                    <input type="radio" id="star5" name="rate" value="5" />
                                    <label for="star5" title="5 stars">5 stars</label>
                                    <input type="radio" id="star4" name="rate" value="4" />
                                    <label for="star4" title="4 stars">4 stars</label>
                                    <input type="radio" id="star3" name="rate" value="3" />
                                    <label for="star3" title="3 stars">3 stars</label>
                                    <input type="radio" id="star2" name="rate" value="2" />
                                    <label for="star2" title="2 stars">2 stars</label>
                                    <input type="radio" id="star1" name="rate" value="1" />
                                    <label for="star1" title="1 star">1 star</label>
                                </div>
                                {{#if errors.rate}}
                                    <small class="invalid-feedback">{{errors.rate}}</small>
                                {{/if}}

                                <button type="submit" class="btn-submit-rating">
                                    <i class="bi bi-send"></i>
                                    Submit Review
                                </button>
                            </form>
                        {{/unless}}
                    {{/ifUserRated}}

                    <!-- Comments List -->
                    <div class="comment-list">
                        {{#if skill.ratings.length}}
                            {{#each skill.ratings as |rating|}}
                                <div class="comment-item">
                                    <div class="comment-header">
                                        <a href="/profile/{{rating.sender.id}}">
                                            <img src="https://i.pravatar.cc/150?u={{rating.sender.email}}"
                                                 alt="{{rating.sender.username}}"
                                                 class="comment-avatar">
                                        </a>
                                        <div class="comment-author">
                                            <a href="/profile/{{rating.sender.id}}" class="comment-author-name">
                                                {{rating.sender.username}}
                                            </a>
                                        </div>
                                        <div class="comment-rating" data-rate="{{rating.rate}}">
                                            <span class="star">&#9733;</span>
                                            <span class="star">&#9733;</span>
                                            <span class="star">&#9733;</span>
                                            <span class="star">&#9733;</span>
                                            <span class="star">&#9733;</span>
                                        </div>
                                    </div>
                                    <p class="comment-text">{{rating.comment}}</p>
                                </div>
                            {{/each}}
                        {{else}}
                            <div class="empty-comments">
                                <i class="bi bi-chat-dots"></i>
                                <p>No reviews yet. Be the first to review this skill!</p>
                            </div>
                        {{/if}}
                    </div>
                </div>
            </aside>
        </div>
    </div>
</div>
