

<!-- Search Section -->
<section class="search-section">
  <div class="container">
    <div class="search-header">
      <h1 class="search-title">Discover Skills</h1>
      <p class="search-subtitle">Find the perfect skill to learn or share your expertise</p>
    </div>

    <form action="/search" method="get" class="search-form">
      <!-- Main Search Bar -->
      <div class="search-bar-wrapper">
        <i class="bi bi-search search-icon"></i>
        <input
          type="text"
          class="search-bar"
          name="name"
          placeholder="Search for skills, topics, or keywords..."
          value="{{query.name}}"
        >
        <button class="search-submit-btn" type="submit">
          Search
        </button>
      </div>

      <!-- Category Chips -->
      <div class="category-chips">
        <input type="hidden" name="category" id="selectedCategory" value="{{query.category}}">

        <button type="button" class="category-chip {{#unless query.category}}active{{/unless}}" data-category="all">
          <i class="bi bi-grid"></i>
          All
        </button>

        <button type="button" class="category-chip {{#ifEq query.category 'technology'}}active{{/ifEq}}" data-category="technology">
          <i class="bi bi-code-slash"></i>
          Technology
        </button>

        <button type="button" class="category-chip {{#ifEq query.category 'cooking'}}active{{/ifEq}}" data-category="cooking">
          <i class="bi bi-cup-hot"></i>
          Cooking
        </button>

        <button type="button" class="category-chip {{#ifEq query.category 'music'}}active{{/ifEq}}" data-category="music">
          <i class="bi bi-music-note"></i>
          Music
        </button>

        <button type="button" class="category-chip {{#ifEq query.category 'sports'}}active{{/ifEq}}" data-category="sports">
          <i class="bi bi-trophy"></i>
          Sports
        </button>

        <button type="button" class="category-chip {{#ifEq query.category 'languages and culture'}}active{{/ifEq}}" data-category="languages and culture">
          <i class="bi bi-translate"></i>
          Languages
        </button>

        <button type="button" class="category-chip {{#ifEq query.category 'crafts'}}active{{/ifEq}}" data-category="crafts">
          <i class="bi bi-brush"></i>
          Crafts
        </button>

        <button type="button" class="category-chip {{#ifEq query.category 'gardening and horticulture'}}active{{/ifEq}}" data-category="gardening and horticulture">
          <i class="bi bi-flower1"></i>
          Gardening
        </button>

        <button type="button" class="category-chip {{#ifEq query.category 'everyday life skills'}}active{{/ifEq}}" data-category="everyday life skills">
          <i class="bi bi-house"></i>
          Life Skills
        </button>

        <button type="button" class="category-chip {{#ifEq query.category 'others'}}active{{/ifEq}}" data-category="others">
          <i class="bi bi-three-dots"></i>
          Others
        </button>
      </div>
    </form>
  </div>
</section>

<script>
  // Category chip selection
  document.querySelectorAll('.category-chip').forEach(chip => {
    chip.addEventListener('click', function() {
      // Remove active class from all chips
      document.querySelectorAll('.category-chip').forEach(c => c.classList.remove('active'));

      // Add active class to clicked chip
      this.classList.add('active');

      // Update hidden input
      const category = this.dataset.category;
      document.getElementById('selectedCategory').value = category === 'all' ? '' : category;

      // Save scroll position before submit
      sessionStorage.setItem('searchScrollPos', window.pageYOffset);
      sessionStorage.setItem('shouldScroll', 'true');

      // Auto-submit form
      this.closest('form').submit();
    });
  });

  // Restore scroll position after page load
  window.addEventListener('load', function() {
    if (sessionStorage.getItem('shouldScroll') === 'true') {
      const scrollPos = sessionStorage.getItem('searchScrollPos');
      if (scrollPos) {
        // Wait a bit for page to render, then scroll
        setTimeout(() => {
          window.scrollTo({
            top: parseInt(scrollPos),
            behavior: 'smooth'
          });
        }, 100);
      }
      sessionStorage.removeItem('shouldScroll');
    }
  });
</script>


<!-- Suggestions Section -->
<section class="skills-section">
  <div class="container">
    <h2 class="skills-title">Suggested For You</h2>
    <div class="skills-grid">
      {{#each skillsByInterests as |skill|}}
      <div class="card" data-category="{{skill.category}}">
        <div class="top-container">
          <a class="img-card" href="/profile/{{skill.owner.id}}">
            <img src="https://i.pravatar.cc/150?u={{skill.owner.email}}" class="profile-image" alt="{{skill.owner.username}}">
          </a>
          <div class="rate" data-rate="{{skill.averageRate}}">
            <div class="stars">
              <span class="star">&#9733;</span>
              <span class="star">&#9733;</span>
              <span class="star">&#9733;</span>
              <span class="star">&#9733;</span>
              <span class="star">&#9733;</span>
            </div>
            <p class="name">{{skill.owner.username}}</p>
          </div>
        </div>
        <a class="card-link" href="/detail/{{skill.id}}">
          <div class="middle-container">
            <div class="category-badge">
              <img src="{{categoryImage skill.category}}" alt="{{skill.category}}">
              <span class="current-balance">{{skill.category}}</span>
            </div>
            <div class="description">
              <p>{{skill.name}}</p>
            </div>
          </div>
        </a>
      </div>
      {{/each}}
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- All Skills Section -->
<section class="skills-section">
  <div class="container">
    <h2 class="skills-title">All Skills</h2>
    <div class="skills-grid">
      {{#each skillsByFinder as |skill|}}
      <div class="card" data-category="{{skill.category}}">
        <div class="top-container">
          <a class="img-card" href="/profile/{{skill.owner.id}}">
            <img src="https://i.pravatar.cc/150?u={{skill.owner.email}}" class="profile-image" alt="{{skill.owner.username}}">
          </a>
          <div class="rate" data-rate="{{skill.averageRate}}">
            <div class="stars">
              <span class="star">&#9733;</span>
              <span class="star">&#9733;</span>
              <span class="star">&#9733;</span>
              <span class="star">&#9733;</span>
              <span class="star">&#9733;</span>
            </div>
            <p class="name">{{skill.owner.username}}</p>
          </div>
        </div>
        <a class="card-link" href="/detail/{{skill.id}}">
          <div class="middle-container">
            <div class="category-badge">
              <img src="{{categoryImage skill.category}}" alt="{{skill.category}}">
              <span class="current-balance">{{skill.category}}</span>
            </div>
            <div class="description">
              <p>{{skill.name}}</p>
            </div>
          </div>
        </a>
      </div>
      {{/each}}
    </div>
  </div>
</section>
















<!-- Carrusel 
  
  <div class="carousel-container d-flex justify-content-end" style="background-color:aqua width: 50%;">
    <div class="carousel">
      {{#each skillsByInterests as |skill|}}
      <div class="card m-3">
        <div class="top-container">
          <a class="img-card" href="/profile/{{skill.owner.id}}"><img src="https://i.pravatar.cc/150?u={{skill.owner.email}}" class="img-fluid profile-image" width="70"></a>
          <div class="rate" style="max-width: 15rem;" data-rate="{{skill.averageRate}}">
            <span class="star">&#9733;</span>
            <span class="star">&#9733;</span>
            <span class="star">&#9733;</span>
            <span class="star">&#9733;</span>
            <span class="star">&#9733;</span>
            <p class="name">{{skill.owner.username}}</p>
          </div>
        </div>
        <a class="text-decoration-none" style="color: black;" href="/detail/{{skill.id}}">
          <div class="middle-container d-flex row justify-content-between align-items-center mt-3 p-2">
            <div class="d-flex flex-row col-md-12 mr-1">
              <img src="{{categoryImage skill.category}}" alt="Img {{skill.category}}" style="width: 20px;" class="mx-1">
              <span class="current-balance">{{skill.category}}</span>
            </div>
            <div class="description">
              <p>{{skill.description}}</p>
            </div>
          </div>
        </a>
      </div>
      {{/each}}
    </div>
  </div>
  <hr>
  <div class="carousel-container d-flex">
    <div class="carousel">
      {{#each skillsByFinder as |skill|}}
      <div class="card m-3">
        <div class="top-container">
          <a class="img-card" href="/profile/{{skill.owner.id}}"><img src="https://i.pravatar.cc/150?u={{skill.owner.email}}" class="img-fluid profile-image" width="70"></a>
          <div class="rate" style="max-width: 15rem;" data-rate="{{skill.averageRate}}">
            <span class="star">&#9733;</span>
            <span class="star">&#9733;</span>
            <span class="star">&#9733;</span>
            <span class="star">&#9733;</span>
            <span class="star">&#9733;</span>
            <p class="name">{{skill.owner.username}}</p>
          </div>
        </div>
        <a class="text-decoration-none" style="color: black;" href="/detail/{{skill.id}}">
          <div class="middle-container d-flex row justify-content-between align-items-center mt-3 p-2">
            <div class="d-flex flex-row col-md-12 mr-1">
              <img src="{{categoryImage skill.category}}" alt="Img {{skill.category}}" style="width: 20px;" class="mx-1">
              <span class="current-balance">{{skill.category}}</span>
            </div>
            <div class="description">
              <p>{{skill.description}}</p>
            </div>
          </div>
        </a>
      </div>
      {{/each}}
    </div>
  </div>-->

<!--
 <script>
        function startCarousel() {
    const carousel = document.querySelector('.carousel');
    const cards = document.querySelectorAll('.carousel .card');
    const prevButton = document.querySelector('.move-prev');
    const nextButton = document.querySelector('.move-next');

    // Calcular el ancho total del carrusel
    const cardWidth = cards[0].offsetWidth;
    const totalWidth = cards.length * cardWidth;

    carousel.style.width = totalWidth + 'px';
    let position = 0;
    let speed = 1;

    prevButton.addEventListener('click', movePrev);
    nextButton.addEventListener('click', moveNext);

    function movePrev() {
        position += cardWidth;
        if (position > 0) {
            position = -totalWidth + carousel.offsetWidth;
        }
        carousel.style.transform = 'translateX(' + position + 'px)';
    }

    function moveNext() {
        position -= cardWidth;
        if (position < -totalWidth + carousel.offsetWidth) {
            position = 0;
        }
        carousel.style.transform = 'translateX(' + position + 'px)';
    }
}

window.addEventListener('load', startCarousel)
    </script>-->